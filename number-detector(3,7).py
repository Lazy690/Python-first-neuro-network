import numpy as np

# Activation functions
def relu(x):
    return np.maximum(0, x)

def softmax(x):
    e_x = np.exp(x - np.max(x))  # Stability trick
    return e_x / e_x.sum(axis=0)

# Function to load weights and biases
def load_weights():
    # Replace these with the weights and biases from your training
    hidden_weights = np.array([[-7.80911059e-01, 2.85379828e-01, 7.0
5137352e-02, 7.80813959e-01,
   3.38591126e-01,-2.08766505e+00,-5.79883014e-01, 1.49347257e+0
0,
   3.50079151e-01, 2.13794247e+00,-3.05401728e+00,-9.43189315e-0
1,
  -8.26243687e-01,-6.74685113e-01,-3.04209862e-02,-1.98070863e+0
0,
  -1.52072735e+00, 4.18115274e-01, 1.04596908e+00,-5.57137131e-0
1,
   6.49542362e-01,-7.83350465e-01, 1.03119300e+00,-5.70958453e-0
1,
   8.18874924e-01, 5.37768446e-02,-1.41931850e+00,-1.17440010e+0
0,
  -1.08403108e+00, 8.53381287e-01,-6.98134586e-01,-4.96683174e-0
1,
   1.91398095e-01, 2.32152148e+00, 5.29409893e-01, 6.09517750e-0
1,
  -4.31793825e-01,-3.71426790e-01, 8.38493981e-01, 1.73993104e+0
0,
   2.12270018e-01,-8.12756815e-01,-4.70647807e-01,-4.94362738e-0
1,
   4.27079641e-01,-1.36100231e-01,-4.78611317e-01,-8.85036411e-0
1,
  -1.80012886e+00,-4.45332381e-01, 8.05504594e-01, 7.68579940e-0
1,
  -6.52357278e-01, 6.16771278e-01, 6.88667755e-02,-1.94309547e-0
1,
   2.67441815e-01, 1.54693738e+00,-1.17444284e+00,-1.13840681e+0
0,
  -2.39132228e+00, 7.18401345e-02, 3.98578871e-01,-2.73567568e+0
0,
   5.29603477e-01, 3.34222992e-01,-6.59727901e-01,-6.33717042e-0
1,
  -1.02961203e+00,-7.02960565e-01,-1.78409237e+00, 5.05748300e-0
1,
   9.16899328e-01,-4.58929294e-01,-1.18882717e-01,-4.35140526e-0
1,
  -9.42231590e-02,-1.19020343e+00,-1.60554135e+00, 1.16647627e-0
2,
  -1.48039675e+00, 1.27455785e+00, 1.01253221e+00, 1.92241941e-0
1,
   3.77713697e-01,-2.82970257e-01, 5.04393660e-01,-2.29761063e-0
1,
   2.38702446e-01,-7.01394815e-01,-2.06974941e-01,-1.07505262e+0
0,
  -3.98046903e-01,-5.28074351e-02,-4.83364116e-01, 1.02198756e+0
0,
  -7.70856467e-01,-1.18803472e-01, 2.28495763e-01,-3.72792125e-0
1,
   1.34596527e+00,-5.33895454e-01,-1.90088332e-01,-7.74351889e-0
2,
  -1.32714643e+00,-2.63492139e-01, 4.27570139e-01,-9.03885279e-0
2,
  -2.46347681e-01,-2.10635289e+00,-2.73881457e-02,-1.60602361e-0
1,
   5.22497786e-02,-3.12835394e-01, 9.50387271e-01,-7.85192330e-0
1,
  -1.14126375e+00,-1.24691232e-02, 1.22834484e+00,-2.16791969e-0
1,
   1.44511700e-01,-8.69963421e-03,-8.19612271e-01, 1.12894502e+0
0,
  -1.39599103e+00, 1.03307972e-01, 1.10470576e+00, 2.65728475e-0
1,
  -1.21144255e+00, 1.83984229e-01, 8.73098937e-01,-5.25275943e-0
1,
  -1.96541456e+00,-6.38568059e-01, 3.80330896e-01,-4.31470438e-0
1,
  -1.84919294e-01,-1.35729717e-01,-1.17469190e+00,-7.20744908e-0
1,
  -8.73455004e-01,-8.13003081e-01, 1.69669325e-01, 2.32707135e-0
1,
  -6.64072809e-02, 5.81566315e-01,-2.66763536e+00,-1.08595165e+0
0,
   1.26566432e+00, 1.11298676e-01,-8.18479622e-01, 5.96067013e-0
1,
  -1.22964622e+00, 2.83114640e-02,-1.50016091e-02, 4.07771812e-0
1,
   6.56285393e-01, 1.59900288e+00, 3.07399447e-02,-8.51264736e-0
1,
   1.09962646e+00, 1.93217085e+00,-2.39183466e-02, 9.40336284e-0
1,
   7.41612786e-01,-6.82925081e-01,-1.02875511e+00, 8.51509079e-0
1,
  -3.69074881e-01, 9.33594112e-02,-3.06201897e-01,-6.36663335e-0
1,
   4.30966757e-01, 1.07721433e+00,-9.77502909e-02, 3.89922568e-0
1,
   1.54258164e+00, 2.17797456e-01, 1.61541389e+00,-2.71117428e-0
1,
  -1.73176305e-01, 2.21387648e-02, 9.51521722e-01,-1.20155413e+0
0,
  -5.51885154e-01,-6.74083472e-01, 1.13310624e+00,-3.17361938e-0
1,
  -5.38315944e-02,-1.84028693e-02,-3.35320833e-01, 7.44701967e-0
1,
   6.67204449e-01,-3.90751113e-01,-5.94755530e-01, 4.95991709e-0
1,
  -6.45536374e-03,-2.61184537e+00, 8.76759354e-01, 1.19033031e+0
0,
  -1.02517759e+00,-1.90681455e+00, 5.69636980e-01,-9.06190328e-0
1,
   2.13517531e+00, 1.43064198e+00,-1.73042538e+00, 1.14018130e+0
0,
   2.34334399e+00, 4.18004410e-01,-3.42830445e-01, 1.77764491e+0
0,
   1.17715262e+00, 8.16508249e-01,-6.26621106e-01,-1.19040995e+0
0,
   1.26419542e+00, 5.62385151e-01, 2.25665777e-01,-7.13771148e-0
1,
   2.17843748e-01, 6.08626523e-01, 1.31168033e-01, 9.57510109e-0
1,
   2.57252999e+00, 1.21242729e+00,-2.08316827e+00, 2.41595670e-0
1,
   1.76102994e-01, 9.99405738e-01, 4.67819669e-01, 6.18403522e-0
3,
   9.79082260e-01, 2.80715960e-02,-1.48839153e+00,-1.94544602e+0
0,
   7.00553403e-01,-4.77677604e-01,-2.52831357e+00,-3.10480688e-0
2,
   1.02462115e+00, 3.41879899e-01, 1.00370518e-01, 1.12744307e+0
0,
  -4.67517467e-01, 1.17823396e+00, 7.85871298e-02, 1.85738491e+0
0,
  -6.78726390e-01,-1.75118495e+00,-2.21090432e+00, 5.94777988e-0
1,
  -2.19088394e+00,-5.27008848e-02, 8.92395245e-01, 1.13030943e-0
1,
  -3.89086681e-03,-5.94735581e-02, 4.04189725e-01,-9.64199536e-0
1,
   7.39381354e-01, 1.07432725e+00, 1.10892650e+00, 3.38806510e+0
0,
   1.01876138e+00,-6.22532021e-01, 7.22303214e-01, 1.76119825e+0
0,
   7.51772636e-01, 1.27170061e-01,-8.47808508e-01,-1.84137077e+0
0,
  -7.42227366e-01, 1.30020884e+00,-1.45079597e+00, 3.85022858e-0
1,
   4.49845845e-01, 6.92632869e-01, 1.01716661e+00,-3.95415379e-0
1,
  -1.45579797e+00, 3.60099411e-01, 1.06402752e+00,-1.23807164e+0
0,
   5.27438570e-01,-2.86219214e-01, 5.01486958e-01,-3.10404293e-0
1,
  -1.41116863e+00, 1.47249272e+00, 1.29797968e+00,-8.54161505e-0
1,
  -1.50279558e+00,-3.73521136e-01,-1.03875178e+00,-1.58235818e+0
0,
   5.16010871e-01,-1.33107912e-01,-1.80658689e+00, 1.13842155e-0
1,
   9.10101950e-01, 1.11231290e+00, 3.55098800e-02, 8.10927487e-0
1,
  -1.86006820e+00,-9.72643612e-01,-1.35949311e-01, 2.91404492e-0
1,
   3.03639907e+00,-9.33458365e-01,-1.73578388e+00, 1.30352173e-0
1,
   1.66012232e+00,-9.22774674e-02,-1.85173197e-01,-1.08230046e+0
0,
   3.53973353e-01, 3.69659228e-01,-2.89753859e+00, 1.14553781e+0
0,
   1.47045483e+00, 2.14641349e+00,-2.02003241e+00, 1.55724589e+0
0,
  -1.72726806e-01, 1.40484256e-01,-9.10480556e-01,-5.48471164e-0
1,
  -1.70782282e-01,-1.48810180e+00,-1.14633600e+00,-3.69718265e-0
1,
   3.22573084e-01, 4.04470855e-02,-2.45286933e-01,-2.62058260e-0
1,
   1.32303604e+00,-9.53336013e-01, 1.08311662e-01,-1.53372833e+0
0,
  -1.15343465e+00,-7.68934839e-01, 5.36778383e-01, 1.37694491e-0
1,
   1.57064608e-01, 5.10125016e-01,-7.64809393e-01, 7.84927624e-0
1,
   4.96103540e-01,-2.86257817e-01, 3.18683094e-01, 9.66399774e-0
1,
   1.35248064e+00,-5.04285413e-01,-9.16927683e-01,-4.28778264e-0
1,
   1.25408271e+00,-2.36499442e-01,-1.06881633e+00,-8.17212354e-0
1,
   1.39199659e+00,-3.84744638e-01, 1.61943577e+00, 2.80490535e-0
1,
  -1.18955962e+00,-1.27546506e+00, 9.75024796e-01,-1.67218451e+0
0,
  -9.28821285e-01,-8.49464027e-01, 1.11112835e+00,-8.54978303e-0
1,
  -5.47343103e-01, 3.45054311e-02, 3.12001499e-01,-4.57600363e-0
2,
  -1.19359290e+00,-6.87973309e-01,-6.25276960e-01,-1.65273088e-0
1,
  -8.46957006e-01, 6.62686959e-01, 1.31865059e-01, 8.47838321e-0
2,
   9.97746028e-01, 8.47990658e-01,-8.22503751e-01,-4.44707061e-0
1,
  -1.68426175e-01, 1.11986385e+00,-6.92537980e-01, 1.48477932e+0
0,
  -2.34073256e+00, 1.33953332e+00,-1.74138525e+00, 2.17991269e+0
0,
   2.07097993e+00,-7.61733924e-01, 2.15045305e-01,-2.82603472e-0
1,
  -1.87773236e-01, 1.39688377e+00,-3.16917361e-01,-1.84233853e+0
0,
   9.88272318e-01, 5.98527154e-01,-3.83684556e-01,-1.85777100e+0
0,
  -5.80239436e-01, 2.27560087e-01, 2.34877411e-01,-3.15247864e-0
1,
   1.87673620e+00, 3.66733583e-01,-2.46558190e-01, 6.22941744e-0
1,
  -1.92647238e-01,-1.48730862e+00, 1.13669338e-01, 1.52338160e+0
0,
   4.33148900e-01, 1.21953393e+00, 5.64740964e-01, 7.02765597e-0
1,
  -1.94988744e+00,-1.41655915e+00, 1.22966188e-01, 6.59823250e-0
2,
  -8.11909379e-02, 1.76333062e-01, 3.23626264e-01, 4.25616718e-0
1,
   7.52727983e-01,-3.23276925e-01, 9.52722368e-02,-4.68954069e-0
1,
   5.56365424e-02,-2.26176244e-01, 1.16676339e+00, 4.55752927e-0
2,
  -1.24136397e-01, 4.26359579e-01, 1.76261608e+00,-1.28877704e+0
0,
  -1.32288684e+00,-2.91675043e-01,-1.63409320e-01, 2.62072801e-0
1,
   1.04041008e+00,-5.62671917e-01, 7.36253324e-01,-3.28163975e-0
1,
  -7.22895759e-02, 1.50590087e+00,-1.30077221e+00,-4.83768362e-0
1,
   1.45341245e+00, 4.07617181e-01,-1.88634550e-01,-3.92083631e-0
1,
   8.42454720e-01,-9.03696769e-01, 3.75704892e-02,-9.31776048e-0
1,
   2.46604967e+00, 1.43595036e+00, 5.77195953e-01, 8.28426025e-0
1,
   7.21903544e-01, 1.18408333e+00,-4.18175201e-01, 3.32739304e-0
1,
   3.64601705e-01, 8.36627737e-02,-1.01974470e-01,-2.97458199e-0
2,
   1.67153737e+00, 1.24024987e+00,-8.27486750e-01, 8.98665421e-0
1,
   2.75959837e-02, 1.20709039e+00, 7.03618913e-01, 1.44297995e+0
0,
  -7.05236570e-01, 1.59740026e+00,-1.18805827e+00,-6.16327968e-0
1,
  -6.59909952e-01, 3.64910605e-01,-4.59804730e-01, 3.91523947e-0
1,
  -1.21041355e+00, 7.49533053e-01, 2.37433491e+00,-1.07770178e+0
0,
  -9.97828833e-01,-3.95344501e-01,-2.34153312e-01,-1.03377435e+0
0,
   9.39376864e-01, 4.75025765e-02,-1.81758556e-01,-1.68768837e+0
0,
   1.55028358e+00,-9.39047429e-01,-7.69828364e-01, 5.81518636e-0
1,
  -1.42171713e+00, 2.22845924e-01,-7.23626558e-01,-5.19288041e-0
1,
  -8.28610743e-02, 2.64345070e-02, 4.10728892e-01, 3.79439905e-0
2,
   6.15869714e-01, 7.55365591e-01, 1.74462752e+00, 6.79446416e-0
1,
  -1.47739573e-01,-2.52776258e-01, 2.53425872e+00, 2.83417453e-0
1,
   2.62090941e-01,-9.88307170e-01, 1.81633081e+00,-1.04013383e+0
0,
  -9.49440373e-01,-7.85615664e-01,-3.59117105e-01,-4.75585318e-0
1,
  -1.06190724e+00, 1.63940817e-01, 6.81144770e-01,-1.60147585e-0
1,
  -1.67601450e+00,-1.23912348e+00,-3.25256323e-01,-8.63339413e-0
1,
   1.11715151e+00,-6.00261276e-01,-1.43990514e+00, 7.26662357e-0
1,
  -3.29673155e-01, 1.10595610e-01,-8.53492185e-04, 6.52485493e-0
1,
  -4.37365260e-01, 9.83585287e-01, 2.28176749e-02, 1.28062068e+0
0,
   5.96991248e-02,-4.06668777e-01, 1.96893839e+00,-1.24803972e-0
1,
  -8.35760201e-01,-5.60913299e-01,-1.25326753e-01, 1.25642816e+0
0,
  -1.12436247e+00,-1.05783359e-01, 9.24639618e-01,-1.32755979e+0
0,
  -1.82837935e+00,-6.74535903e-02,-1.98976777e+00,-4.87215382e-0
1,
  -4.27119856e-02,-1.42845711e+00, 4.83010141e-01, 2.12611910e-0
1,
   3.55867957e-01,-5.80766463e-02,-5.24010849e-01, 7.13121867e-0
1,
  -1.37137823e+00,-6.61085506e-01,-8.91483243e-01, 3.74924499e-0
1,
   1.03442342e+00,-7.92492792e-01, 7.25730215e-01,-1.50034846e+0
0,
  -1.53774889e+00,-7.09374009e-01,-6.57230731e-01,-4.16194027e-0
1,
   2.42544808e+00,-2.55184648e+00, 1.78768937e+00,-6.01954454e-0
2,
   7.23584297e-02,-1.99647453e+00,-2.45073585e+00, 5.75410358e-0
1,
  -1.16248577e+00,-5.84625861e-01, 3.44006684e-01,-1.12018557e-0
1,
  -2.12930247e+00, 9.21655335e-01, 6.97703662e-01, 2.19186647e+0
0,
   5.17885892e-01,-2.17122310e+00,-1.13267308e+00, 4.83519477e-0
1,
   1.17599832e+00,-1.86480076e+00, 6.16213077e-01, 8.74025641e-0
1,
   1.82004453e+00, 3.93449734e-02, 3.02402842e-01, 6.77962788e-0
1,
   4.52745251e-01, 1.11826794e+00,-7.40545465e-01,-8.16883618e-0
1,
  -4.57803188e-01,-2.42287942e-01,-8.87319971e-01, 9.40213163e-0
1,
   2.02602248e+00, 3.34787423e-02, 1.60983206e-01, 1.76979708e+0
0,
  -2.28360936e-01, 6.49174976e-01,-1.13619228e+00, 1.59139663e-0
2,
   2.08791810e-01, 1.60963349e+00, 4.44119661e-01, 1.17128339e+0
0,
   1.85435858e-01, 1.50993373e+00,-1.39389921e+00,-1.25690382e+0
0,
  -1.15146314e+00, 6.14624561e-01,-7.32883332e-01, 2.03480204e+0
0,
   3.73138760e-03, 1.15370457e-01, 4.09311601e-01,-6.33400757e-0
1,
  -1.33095369e+00, 1.06145839e+00, 9.67955800e-01, 7.95639073e-0
1,
   1.24908338e+00,-7.72382699e-02,-3.19810612e-01,-5.06310911e-0
1,
  -5.23733768e-01, 1.01137242e-01, 8.27952227e-01,-4.44414513e-0
1,
   3.13739039e-01,-2.94770196e-01,-4.18934702e-01, 4.16455623e-0
1,
   1.12342516e+00, 7.77175756e-01, 3.58768909e-01,-9.67094384e-0
1,
   4.27025321e-02, 7.01156729e-01, 2.51696504e-01,-1.10957068e+0
0,
   4.32828672e-01,-9.09265213e-01, 1.46634595e-01,-4.24072035e-0
1,
  -7.53231190e-01, 8.45024510e-01,-1.76399569e-01, 7.87265508e-0
1,
   3.50947278e-01, 7.93780111e-01, 2.01858330e+00,-5.34105285e-0
1,
   1.86170121e+00,-1.07308926e+00, 1.41285449e+00, 1.65730049e+0
0,
  -4.85658324e-01, 1.83290081e-01, 2.51157024e-01,-1.89321941e+0
0,
   3.02653508e-01,-3.28851030e-01,-1.80838324e+00, 1.06510625e+0
0,
  -1.00454940e+00, 1.65110544e+00, 3.09437586e-01,-2.70821643e+0
0,
   1.79183143e+00,-3.95794242e-01,-6.76935338e-01,-3.29668052e+0
0,
  -3.76608908e-01, 1.78500472e-01,-1.13560354e+00, 1.80934259e+0
0,
  -1.38448598e+00,-2.40362511e+00, 2.05407562e+00,-2.90473608e-0
1,
   7.96936892e-01,-4.74769576e-01,-1.55636603e+00,-2.03320507e+0
0,
   8.90561570e-02,-4.13248108e-01, 5.51923077e-01,-7.68355659e-0
1,
  -1.53050074e+00, 3],])
        # Add your trained hidden_weights here
    
    hidden_biases = np.array([
        # Add your trained hidden_biases here
    ])
    output_weights = np.array([
        # Add your trained output_weights here
    ])
    output_biases = np.array([
        # Add your trained output_biases here
    ])
    return hidden_weights, hidden_biases, output_weights, output_biases

# Function to predict the class of a number
def predict_number(input_pattern, hidden_weights, hidden_biases, output_weights, output_biases):
    # Flatten the input pattern
    input_pattern = input_pattern.flatten()

    # Forward pass
    hidden_input = np.dot(hidden_weights, input_pattern) + hidden_biases
    hidden_output = relu(hidden_input)

    final_input = np.dot(output_weights, hidden_output) + output_biases
    output = softmax(final_input)

    # Determine the predicted class
    predicted_class = np.argmax(output)  # 0 for 3, 1 for 7
    confidence = output[predicted_class] * 100

    return predicted_class, confidence

# Main function
if __name__ == "__main__":
    # Load the trained weights and biases
    hidden_weights, hidden_biases, output_weights, output_biases = load_weights()

    # Example input pattern (replace with your test data)
    test_pattern = np.array([
        # Add a flattened grayscale image array here (e.g., 729 values)
    ])

    # Predict the number
    predicted_class, confidence = predict_number(
        test_pattern, hidden_weights, hidden_biases, output_weights, output_biases
    )

    # Output the result
    if predicted_class == 0:
        print(f"The number is likely a 3 with {confidence:.2f}% confidence.")
    elif predicted_class == 1:
        print(f"The number is likely a 7 with {confidence:.2f}% confidence.")